### Dar de alta alumno
POST http://localhost:4004/odata/v2/academic/Alumnos
Content-Type: application/json

{
    "dni": "41531236",
    "nombre": "Federico",
    "apellido": "Gavaz",
    "email": "federicogavaz@juanXXIII.com"
}

### Probar Action Ping
POST http://localhost:4004/odata/v2/academic/ping
Content-Type: application/json


###
### Materias de un plan específico
GET http://localhost:4004/odata/v2/academic/Materias?$filter=plan_ID eq 22222222-3333-4444-8555-666666666001


###
### Planes y su carrera
GET http://localhost:4004/odata/v4/academic/PlanCarreras?$select=ID,anioVigencia,estado&$expand=carrera($select=nombre,codigo)

### (Decano) Crear PlanMateria
POST http://localhost:4004/odata/v4/academic/PlanMaterias
Authorization: Basic decano:
Content-Type: application/json

{
  "ID": "pm-3333-4444-5555-6666-777777777001",
  "plan_ID": "11111111-2222-4333-8444-555555555001",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0001",
  "anio": 1,
  "semestre": "S1"
}

### (Alumno/consulta) Ver materias (solo planes Publicados)
GET http://localhost:4004/odata/v2/academic/PlanMaterias?$filter=plan_ID eq 11111111-2222-4333-8444-555555555001&$expand=materia($select=nombre)




### 1) Error: faltan campos obligatorios
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{}

### 2) Error: Plan no encontrado
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "00000000-0000-0000-0000-000000000999",
  "materia_ID": "11111111-1111-1111-1111-111111111111",
  "anio": 1,
  "semestre": "S1"
}

### 3) Error: Plan no editable (estado ≠ Borrador)
# Asegurate de tener creado un PlanCarrera con estado = "Activo"
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555007",
  "materia_ID": "11111111-1111-1111-1111-111111111111",
  "anio": 1,
  "semestre": "S1"
}

### 4) Error: Materia no encontrada
# Asegurate de tener un PlanCarrera en Borrador
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "<ID_DE_PLAN_BORRADOR>",
  "materia_ID": "00000000-0000-0000-0000-000000000999",
  "anio": 1,
  "semestre": "S1"
}

### 5) Error: Año fuera de rango
# plan.duracionAnios = 3
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555007",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0015",
  "anio": 6,
  "semestre": "S1"
}

### 6) Error: Semestre inválido
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555007",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0015",
  "anio": 1,
  "semestre": "S3"
}

### 7) Error: Duplicado plan + materia
# Primero crear un registro válido en PlanMateria con ese plan_ID y materia_ID
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555007",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0015",
  "anio": 1,
  "semestre": "S1"
}





### (Decano) Ver todo (incluye Borrador/Archivado)
GET http://localhost:4004/odata/v2/academic/PlanMaterias?$filter=ID eq 6165fb41-9a72-4ce9-b244-47c38b240932



### Crear una fila en PlanMateria (plan en Borrador) para poder hacer PUT
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555006",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0013",
  "anio": 1,
  "semestre": "S1"
}

### PUT OK: cambiar anio/semestre/estado (mismos plan_ID y materia_ID)
PUT http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

{
  "anio": 2,
  "semestre": "S2",
  "estado": "Optativa"
}

### PUT ERROR: semestre inválido (solo S1/S2) -> 400
PUT http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

{
  "plan_ID": "11111111-2222-1333-8444-555555555006",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0013",
  "anio": 2,
  "semestre": "S1",
  "estado": "Activa"
}

### PUT ERROR: año fuera de rango (plan 555007 dura 5) -> 400
PUT http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

{
  "anio": 6,
  "semestre": "S1",
  "estado": "Activa"
}

### PUT ERROR: intentar cambiar materia_ID (no permitido) -> 400
PUT http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555007",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0001",
  "anio": 2,
  "semestre": "S1",
  "estado": "Activa"
}

### PUT ERROR: intentar cambiar plan_ID (no permitido) -> 400
PUT http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555001",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0015",
  "anio": 2,
  "semestre": "S1",
  "estado": "Activa"
}


### OK (plan en Borrador)
DELETE http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'6165fb41-9a72-4ce9-b244-47c38b240932')
Content-Type: application/json

### Bloqueado: plan no está en Borrador (por ejemplo Vigente/Publicado)
DELETE http://localhost:4004/odata/v2/academic/PlanMaterias(ID='3f1c5c90-5d3a-4b5e-8b9f-0a7f8b2a0001')
Content-Type: application/json
### No encontrado
DELETE http://localhost:4004/odata/v2/academic/PlanMaterias(ID=guid'00000000-0000-0000-0000-000000000000')
Content-Type: application/json






###
GET http://localhost:4004/odata/v2/academic/PlanMaterias

###
POST http://localhost:4004/odata/v2/academic/PlanMaterias
Content-Type: application/json

{
  "plan_ID": "11111111-2222-4333-8444-555555555006",
  "materia_ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0006",
  "anio": 1,
  "semestre": "S1",
  "estado": "Activa"
}



### CREATE OK
POST http://localhost:4004/odata/v2/academic/PlanCarreras
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234",
  "carrera_ID": "9b4b9b90-6a2b-4d61-9b1e-6b8b5c2a1001",
  "anioVigencia": 2026,
  "duracionAnios": 3,
  "estado": "Borrador"
}

### CREATE duplicado carrera+año -> 409
POST http://localhost:4004/odata/v2/academic/PlanCarreras
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee5678",
  "carrera_ID": "9b4b9b90-6a2b-4d61-9b1e-6b8b5c2a1001",
  "anioVigencia": 2026,
  "duracionAnios": 3,
  "estado": "Borrador"
}

### UPDATE OK (PUT) — cambiando duración
PUT http://localhost:4004/odata/v2/academic/PlanCarreras(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234')
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234",
  "carrera_ID": "9b4b9b90-6a2b-4d61-9b1e-6b8b5c2a1001",
  "anioVigencia": 2026,
  "duracionAnios": 4,
  "estado": "Borrador"
}

### UPDATE ERROR — intentar cambiar carrera_ID
PUT http://localhost:4004/odata/v2/academic/PlanCarreras(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234')
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234",
  "carrera_ID": "f1a2b3c4-d5e6-47f8-9a10-112233445501",   
  "anioVigencia": 2026,
  "duracionAnios": 4,
  "estado": "Borrador"
}

### UPDATE ERROR — anioVigencia fuera de rango
PATCH http://localhost:4004/odata/v2/academic/PlanCarreras(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234')
Content-Type: application/json

{ "anioVigencia": 1999 }

### DELETE ERROR — si tiene PlanMaterias o no está en Borrador
DELETE http://localhost:4004/odata/v2/academic/PlanCarreras(ID=guid'11111111-2222-4333-8444-555555555001')

### DELETE OK — plan en Borrador sin materias
DELETE http://localhost:4004/odata/v2/academic/PlanCarreras(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee1234')





### CREATE OK
POST http://localhost:4004/odata/v2/academic/Materias
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee9999",
  "nombre": "Introducción a la Robótica"
}

### CREATE ERROR: nombre vacío
POST http://localhost:4004/odata/v2/academic/Materias
Content-Type: application/json

{ "nombre": "   " }

### CREATE ERROR: duplicado (exacto)
POST http://localhost:4004/odata/v2/academic/Materias
Content-Type: application/json

{ "nombre": "Introducción a la Robótica" }

### PUT OK: renombrar (mismo ID)
PUT http://localhost:4004/odata/v2/academic/Materias(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee9999')
Content-Type: application/json

{
  "ID": "aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee9999",
  "nombre": "Robótica I"
}

### DELETE ERROR: en uso por PlanMateria
DELETE http://localhost:4004/odata/v2/academic/Materias(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee0001')

### DELETE OK: sin referencias
DELETE http://localhost:4004/odata/v2/academic/Materias(ID=guid'aaaaaaaa-bbbb-4ccc-8ddd-eeeeeeee9999')




### CREATE OK
POST http://localhost:4004/odata/v2/academic/Carreras
Content-Type: application/json

{
  "ID": "b1b1b1b1-2222-3333-4444-555555555555",
  "codigo": "lic-soft",
  "nombre": "Licenciatura en Software",
  "tipo": "Grado"
}

### CREATE ERROR: código inválido (espacios / largo)
POST http://localhost:4004/odata/v2/academic/Carreras
Content-Type: application/json

{
  "codigo": "CODIGO MUY LARGO 123",
  "nombre": "Prueba",
  "tipo": "Tecnicatura"
}

### CREATE ERROR: código duplicado
POST http://localhost:4004/odata/v2/academic/Carreras
Content-Type: application/json

{
  "codigo": "LIC-SOFT",              
  "nombre": "Otra carrera",
  "tipo": "Grado"
}

### PUT OK: cambiar nombre/tipo (código inmutable)
PUT http://localhost:4004/odata/v2/academic/Carreras(ID=guid'b1b1b1b1-2222-3333-4444-555555555555')
Content-Type: application/json

{
  "ID": "b1b1b1b1-2222-3333-4444-555555555555",
  "codigo": "LIC-SOFT",
  "nombre": "Licenciatura en Ingeniería de Software",
  "tipo": "Grado"
}

### PUT ERROR: intentar cambiar código
PUT http://localhost:4004/odata/v2/academic/Carreras(ID=guid'b1b1b1b1-2222-3333-4444-555555555555')
Content-Type: application/json

{
  "ID": "b1b1b1b1-2222-3333-4444-555555555555",
  "codigo": "NUEVO-COA",
  "nombre": "Lic. Ingeniería de Software",
  "tipo": "Grado"
}

### DELETE ERROR: carrera usada por un plan
DELETE http://localhost:4004/odata/v2/academic/Carreras(ID=guid'9b4b9b90-6a2b-4d61-9b1e-6b8b5c2a1001')

### DELETE OK: carrera sin planes
DELETE http://localhost:4004/odata/v2/academic/Carreras(ID=guid'b1b1b1b1-2222-3333-4444-555555555555')
